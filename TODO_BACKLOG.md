# Nini 后续开发待办清单

## 使用说明

- 文档用途：将当前架构优化后的剩余工作收敛为可执行 backlog。
- 优先级定义：
  - `P1`：建议优先推进，直接影响架构闭环或核心体验。
  - `P2`：重要但不阻塞主链路，可在 P1 完成后推进。
  - `P3`：持续优化项，适合穿插处理。

---

## P1：架构闭环

### 1. 完成 `ResearchProfile` 四层记忆闭环

- 状态：进行中
- 目标：
  - 让研究偏好、常用方法、输出风格跨会话保存
  - 接入运行时上下文注入
- 验收标准：
  - 支持读取和更新默认研究画像
  - Session 能绑定 `research_profile_id`
  - Runner 能注入研究画像提示
  - 补充持久化与上下文测试

### 2. 实现第二个可执行 Capability

- 状态：未开始
- 推荐目标：
  - `data_exploration`
  - 或 `correlation_analysis`
- 验收标准：
  - 注册表统一发现和执行
  - API 可直接执行
  - 前端能力面板能正确标记执行状态

### 3. Intent Layer 升级为增强语义版本

- 状态：未开始
- 目标：
  - 在现有规则版基础上增强长尾表达理解
- 候选方向：
  - 元数据加权排序
  - embedding 检索
  - 历史交互辅助排序
- 验收标准：
  - 对隐式科研任务的匹配优于规则版
  - 保留规则回退路径

---

## P2：体验与科研专项深化

### 4. 前端 Intent 交互深化

- 状态：未开始
- 目标：
  - 从顶部摘要卡扩展到对话级反馈
- 待办：
  - 在时间线中展示系统理解和澄清过程
  - 展示激活技能和推荐路径
  - 对工具调用前的推荐给出更直观提示

### 5. 科研专项方法推荐增强

- 状态：未开始
- 目标：
  - 提升方法选择解释的统计严谨性
- 待办：
  - 增强前提检验和方法回退策略
  - 增强多重比较、效应量、置信区间解释模板
  - 加强局限性与风险提示

### 6. 发表级输出模板化

- 状态：未开始
- 目标：
  - 提升研究报告与图表输出的一致性
- 待办：
  - 统一报告结构模板
  - 引入结果摘要、方法说明、局限性标准段落
  - 统一 journal style 与导出策略

### 7. MCP Gateway 与新架构收口

- 状态：未开始
- 目标：
  - 让外部生态能力更自然地对齐 Intent / Capability / Skill Runtime
- 待办：
  - 清理对内部结构的直接访问
  - 用公开注册表接口替代私有字段依赖

---

## P3：工程质量与性能优化

### 8. 前端大包优化

- 状态：未开始
- 背景：
  - `npm run build` 仍提示 `plotly` chunk 偏大
- 待办：
  - 动态加载图表模块
  - 分析是否能拆分导出与预览依赖

### 9. 可观测性增强

- 状态：未开始
- 待办：
  - 记录 Intent 分析耗时
  - 记录 Capability / Skill 执行耗时
  - 聚合工具失败原因

### 10. 稳定性与恢复能力

- 状态：未开始
- 待办：
  - WebSocket 断线恢复
  - 工具调用失败重试策略
  - 长任务状态恢复与提示

---

## 推荐执行顺序

1. 收口 `ResearchProfile`
2. 实现第二个可执行 Capability
3. 升级 Intent 语义理解
4. 深化前端 Intent 体验
5. 推进科研专项输出与方法推荐
6. 再收口 MCP、性能和可观测性
